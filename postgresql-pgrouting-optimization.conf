# PostgreSQL Configuration for pgRouting Optimization
# Add these settings to your postgresql.conf file

# Memory Settings for Large Routing Operations
shared_buffers = 2GB                    # 25% of total RAM
work_mem = 1GB                          # Per-operation memory
maintenance_work_mem = 1GB              # For index maintenance
effective_cache_size = 8GB              # 75% of total RAM
temp_buffers = 256MB                    # Temporary table memory

# Parallel Processing
max_parallel_workers_per_gather = 4     # Parallel workers per query
max_parallel_workers = 8                # Total parallel workers
max_parallel_maintenance_workers = 4    # Parallel maintenance workers

# Query Optimization
random_page_cost = 1.1                  # SSD optimization
seq_page_cost = 1.0                     # Sequential scan cost
hash_mem_multiplier = 2.0               # Hash table memory multiplier

# Timeouts
statement_timeout = 1800s                # 30 minutes for routing queries
lock_timeout = 30s                      # Lock timeout

# Connection Settings
max_connections = 100                   # Adjust based on your needs

# Logging (for debugging routing issues)
log_min_duration_statement = 1000       # Log queries taking > 1 second
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
log_checkpoints = on
log_connections = on
log_disconnections = on
log_lock_waits = on

# WAL Settings (for better performance)
wal_buffers = 64MB
checkpoint_completion_target = 0.9
checkpoint_timeout = 15min
max_wal_size = 4GB
min_wal_size = 1GB
